<linkset>
  <html:link rel="localization" href="__addonRef__-preferences.ftl" />
</linkset>
<groupbox
  onload="Zotero.__addonInstance__.hooks.onPrefsEvent('load', { window })"
>
  <label><html:h2 data-l10n-id="pref-title"></html:h2></label>

  <!-- API Configuration Section -->
  <html:fieldset>
    <html:legend>API Configuration</html:legend>
    <hbox align="center">
      <html:label for="marginalia-apiUrl" style="width: 120px;">API URL:</html:label>
      <html:input
        type="text"
        id="marginalia-apiUrl"
        preference="apiUrl"
        flex="1"
        placeholder="https://api.openai.com/v1"
      />
    </hbox>
    <hbox align="center">
      <html:label for="marginalia-apiKey" style="width: 120px;">API Key:</html:label>
      <html:input
        type="password"
        id="marginalia-apiKey"
        preference="apiKey"
        flex="1"
      />
    </hbox>
    <hbox align="center">
      <html:label for="marginalia-model" style="width: 120px;">Model:</html:label>
      <html:input
        type="text"
        id="marginalia-model"
        preference="model"
        flex="1"
        placeholder="gpt-4o-mini"
      />
    </hbox>
    <hbox>
      <button id="marginalia-test-connection" label="Test Connection" />
      <button id="marginalia-save-settings" label="Save" />
    </hbox>
  </html:fieldset>

  <!-- Chat Settings Section -->
  <html:fieldset>
    <html:legend>Chat Settings</html:legend>
    <hbox align="center">
      <html:label for="marginalia-maxHistoryRounds" style="width: 120px;">Max History Rounds:</html:label>
      <html:input
        type="number"
        id="marginalia-maxHistoryRounds"
        preference="maxHistoryRounds"
        min="1"
        max="100"
        value="20"
        style="width: 60px;"
      />
    </hbox>
    <hbox align="center">
      <checkbox
        id="marginalia-enableToolCalling"
        preference="enableToolCalling"
        label="Enable Tool Calling"
      />
    </hbox>
  </html:fieldset>
</groupbox>
<vbox>
  <html:label
    data-l10n-id="pref-help"
    data-l10n-args='{"time": "__buildTime__","name": "__addonName__","version":"__buildVersion__"}'
  ></html:label>
</vbox>
